<!DOCTYPE html>
<html>
<head>
</head>
<body>
<p style="text-align: center;"><strong>Резервное копирование Exchange 2013</strong></p>
<p style="text-align: justify;">&nbsp;В данной статье будет рассмотрено резервное копирование не только баз данных, но и некоторой конфигурации. Например, данные 206 команды сохраняют большенство серверных и пользовательских настроек. Они могут пригодиться при восстановлении в случае когда и контроллер домен вышел из строя и нет его резервных копий. Я рекомендую выполнить данные команды сразу после установки Exchange 2013. Иногда может понадобится узнать настройки по умолчанию.</p>
<pre>Get-AcceptedDomain | fl * &gt; c:\backup\Get-AcceptedDomain.txt<br />Get-ActiveSyncDeviceAccessRule | fl * &gt; c:\backup\Get-ActiveSyncDeviceAccessRule.txt<br />Get-ActiveSyncDeviceAutoblockThreshold | fl * &gt; c:\backup\Get-ActiveSyncDeviceAutoblockThreshold.txt<br />Get-ActiveSyncDeviceClass | fl * &gt; c:\backup\Get-ActiveSyncDeviceClass.txt<br />Get-Mailbox | Get-ActiveSyncDeviceStatistics | fl * &gt; c:\backup\Get-ActiveSyncDeviceStatistics.txt<br />Get-ActiveSyncMailboxPolicy | fl * &gt; c:\backup\Get-ActiveSyncMailboxPolicy.txt<br />Get-ActiveSyncOrganizationSettings | fl * &gt; c:\backup\Get-ActiveSyncOrganizationSettings.txt<br />Get-ActiveSyncVirtualDirectory | fl * &gt; c:\backup\Get-ActiveSyncVirtualDirectory.txt<br />Get-AddressBookPolicy | fl * &gt; c:\backup\Get-AddressBookPolicy.txt<br />Get-AddressList | fl * &gt; c:\backup\Get-AddressList.txt<br />Get-AdminAuditLogConfig | fl * &gt; c:\backup\Get-AdminAuditLogConfig.txt<br />Get-Mailbox | Get-ADPermission | fl * &gt; c:\backup\Get-ADPermission.txt<br />Get-ADServerSettings | fl * &gt; c:\backup\Get-ADServerSettings.txt<br />Get-ADSite | fl * &gt; c:\backup\Get-ADSite.txt<br />Get-AdSiteLink | fl * &gt; c:\backup\Get-AdSiteLink.txt<br />Get-AgentLog | fl * &gt; c:\backup\Get-AgentLog.txt<br />Get-App | fl * &gt; c:\backup\Get-App.txt<br />Get-AuditLogSearch | fl * &gt; c:\backup\Get-AuditLogSearch.txt<br />Get-AuthConfig | fl * &gt; c:\backup\Get-AuthConfig.txt<br />Get-AuthRedirect | fl * &gt; c:\backup\Get-AuthRedirect.txt<br />Get-AuthServer | fl * &gt; c:\backup\Get-AuthServer.txt<br />Get-AutodiscoverVirtualDirectory | fl * &gt; c:\backup\Get-AutodiscoverVirtualDirectory.txt<br />Get-AvailabilityAddressSpace | fl * &gt; c:\backup\Get-AvailabilityAddressSpace.txt<br />Get-AvailabilityConfig | fl * &gt; c:\backup\Get-AvailabilityConfig.txt<br />Get-CASMailbox | fl * &gt; c:\backup\Get-CASMailbox.txt<br />Get-ClassificationRuleCollection | fl * &gt; c:\backup\Get-ClassificationRuleCollection.txt<br />Get-ClientAccessArray | fl * &gt; c:\backup\Get-ClientAccessArray.txt<br />Get-ClientAccessServer | fl * &gt; c:\backup\Get-ClientAccessServer.txt<br />Get-CmdletExtensionAgent | fl * &gt; c:\backup\Get-CmdletExtensionAgent.txt<br />Get-Contact | fl * &gt; c:\backup\Get-Contact.txt<br />Get-ContentFilterConfig | fl * &gt; c:\backup\Get-ContentFilterConfig.txt<br />Get-ContentFilterPhrase | fl * &gt; c:\backup\Get-ContentFilterPhrase.txt<br />Get-DatabaseAvailabilityGroup | fl * &gt; c:\backup\Get-DatabaseAvailabilityGroup.txt<br />Get-DatabaseAvailabilityGroupConfiguration | fl * &gt; c:\backup\Get-DatabaseAvailabilityGroupConfiguration.txt<br />Get-DatabaseAvailabilityGroupNetwork | fl * &gt; c:\backup\Get-DatabaseAvailabilityGroupNetwork.txt<br />Get-DataClassification | fl * &gt; c:\backup\Get-DataClassification.txt<br />Get-DeliveryAgentConnector | fl * &gt; c:\backup\Get-DeliveryAgentConnector.txt<br />Get-DetailsTemplate | fl * &gt; c:\backup\Get-DetailsTemplate.txt<br />Get-DistributionGroup | fl * &gt; c:\backup\Get-DistributionGroup.txt<br />foreach ($group in Get-DistributionGroup) { get-distributiongroupmember $group.DisplayName | ft @{expression={$_.displayname};Label="$group"} &gt;&gt; C:\backup\Get-DistributionGroupMember.txt}<br />Get-DlpPolicy | fl * &gt; c:\backup\Get-DlpPolicy.txt<br />Get-DlpPolicyTemplate | fl * &gt; c:\backup\Get-DlpPolicyTemplate.txt<br />Get-DomainController | fl * &gt; c:\backup\Get-DomainController.txt<br />Get-DynamicDistributionGroup | fl * &gt; c:\backup\Get-DynamicDistributionGroup.txt<br />Get-EcpVirtualDirectory | fl * &gt; c:\backup\Get-EcpVirtualDirectory.txt<br />Get-EdgeSubscription | fl * &gt; c:\backup\Get-EdgeSubscription.txt<br />Get-EdgeSyncServiceConfig | fl * &gt; c:\backup\Get-EdgeSyncServiceConfig.txt<br />Get-EmailAddressPolicy | fl * &gt; c:\backup\Get-EmailAddressPolicy.txt<br />Get-EventLogLevel | fl * &gt; c:\backup\Get-EventLogLevel.txt<br />Get-ExchangeAssistanceConfig | fl * &gt; c:\backup\Get-ExchangeAssistanceConfig.txt<br />Get-ExchangeCertificate | fl * &gt; c:\backup\Get-ExchangeCertificate.txt<br />Get-ExchangeDiagnosticInfo | fl * &gt; c:\backup\Get-ExchangeDiagnosticInfo.txt<br />Get-ExchangeServer | fl * &gt; c:\backup\Get-ExchangeServer.txt<br />Get-ExchangeServerAccessLicense | fl * &gt; c:\backup\Get-ExchangeServerAccessLicense.txt<br />Get-ExchangeServer | Get-FailedContentIndexDocuments | fl * &gt; c:\backup\Get-FailedContentIndexDocuments.txt<br />Get-ForeignConnector | fl * &gt; c:\backup\Get-ForeignConnector.txt<br />Get-FrontendTransportService | fl * &gt; c:\backup\Get-FrontendTransportService.txt<br />Get-GlobalAddressList | fl * &gt; c:\backup\Get-GlobalAddressList.txt<br />Get-GlobalMonitoringOverride | fl * &gt; c:\backup\Get-GlobalMonitoringOverride.txt<br />Get-Group | fl * &gt; c:\backup\Get-Group.txt<br />Get-mailboxserver | Get-HealthReport | fl * &gt; c:\backup\Get-HealthReport.txt<br />Get-HostedContentFilterRule | fl * &gt; c:\backup\Get-HostedContentFilterRule.txt<br />Get-HybridConfiguration | fl * &gt; c:\backup\Get-HybridConfiguration.txt<br />Get-ImapSettings | fl * &gt; c:\backup\Get-ImapSettings.txt<br />Get-InboxRule | fl * &gt; c:\backup\Get-InboxRule.txt<br />Get-IntraOrganizationConfiguration | fl * &gt; c:\backup\Get-IntraOrganizationConfiguration.txt<br />Get-IntraOrganizationConnector | fl * &gt; c:\backup\Get-IntraOrganizationConnector.txt<br />Get-IPAllowListConfig | fl * &gt; c:\backup\Get-IPAllowListConfig.txt<br />Get-IPAllowListEntry | fl * &gt; c:\backup\Get-IPAllowListEntry.txt<br />Get-IPAllowListProvider | fl * &gt; c:\backup\Get-IPAllowListProvider.txt<br />Get-IPAllowListProvidersConfig | fl * &gt; c:\backup\Get-IPAllowListProvidersConfig.txt<br />Get-IPBlockListConfig | fl * &gt; c:\backup\Get-IPBlockListConfig.txt<br />Get-IPBlockListEntry | fl * &gt; c:\backup\Get-IPBlockListEntry.txt<br />Get-IPBlockListProvider | fl * &gt; c:\backup\Get-IPBlockListProvider.txt<br />Get-IPBlockListProvidersConfig | fl * &gt; c:\backup\Get-IPBlockListProvidersConfig.txt<br />Get-IRMConfiguration | fl * &gt; c:\backup\Get-IRMConfiguration.txt<br />Get-JournalRule | fl * &gt; c:\backup\Get-JournalRule.txt<br />Get-mailboxserver | Get-LogonStatistics | fl * &gt; c:\backup\Get-LogonStatistics.txt<br />Get-Mailbox | fl * &gt; c:\backup\Get-Mailbox.txt<br />Get-MailboxAuditBypassAssociation | fl * &gt; c:\backup\Get-MailboxAuditBypassAssociation.txt<br />Get-MailboxAutoReplyConfiguration -Identity * | fl * &gt; c:\backup\Get-MailboxAutoReplyConfiguration.txt<br />Get-MailboxDatabase | fl * &gt; c:\backup\Get-MailboxDatabase.txt<br />Get-MailboxDatabaseCopyStatus | fl * &gt; c:\backup\Get-MailboxDatabaseCopyStatus.txt<br />Get-mailbox | Get-MailboxFolderPermission | fl * &gt; c:\backup\Get-MailboxFolderPermission.txt<br />Get-mailbox | Get-MailboxFolderStatistics | fl * &gt; c:\backup\Get-MailboxFolderStatistics.txt<br />Get-mailbox | Get-MailboxJunkEmailConfiguration | fl * &gt; c:\backup\Get-MailboxJunkEmailConfiguration.txt<br />Get-mailbox | Get-MailboxMessageConfiguration | fl * &gt; c:\backup\Get-MailboxMessageConfiguration.txt<br />Get-mailbox | Get-MailboxPermission | fl * &gt; c:\backup\Get-MailboxPermission.txt<br />Get-mailbox | Get-MailboxRegionalConfiguration | fl * &gt; c:\backup\Get-MailboxRegionalConfiguration.txt<br />Get-MailboxSearch | fl * &gt; c:\backup\Get-MailboxSearch.txt<br />Get-MailboxServer | fl * &gt; c:\backup\Get-MailboxServer.txt<br />Get-mailbox | Get-MailboxSpellingConfiguration | fl * &gt; c:\backup\Get-MailboxSpellingConfiguration.txt<br />Get-mailbox | Get-MailboxStatistics | fl * &gt; c:\backup\Get-MailboxStatistics.txt<br />Get-MailboxTransportService | fl * &gt; c:\backup\Get-MailboxTransportService.txt<br />Get-MailContact | fl * &gt; c:\backup\Get-MailContact.txt<br />Get-MailPublicFolder | fl * &gt; c:\backup\Get-MailPublicFolder.txt<br />Get-MailUser | fl * &gt; c:\backup\Get-MailUser.txt<br />Get-MalwareFilteringServer | fl * &gt; c:\backup\Get-MalwareFilteringServer.txt<br />Get-MalwareFilterPolicy | fl * &gt; c:\backup\Get-MalwareFilterPolicy.txt<br />Get-MalwareFilterRule | fl * &gt; c:\backup\Get-MalwareFilterRule.txt<br />Get-ManagementRole | fl * &gt; c:\backup\Get-ManagementRole.txt<br />Get-ManagementRoleAssignment | fl * &gt; c:\backup\Get-ManagementRoleAssignment.txt<br />Get-ManagementScope | fl * &gt; c:\backup\Get-ManagementScope.txt<br />Get-MapiVirtualDirectory | fl * &gt; c:\backup\Get-MapiVirtualDirectory.txt<br />Get-Message | fl * &gt; c:\backup\Get-Message.txt<br />Get-MessageCategory | fl * &gt; c:\backup\Get-MessageCategory.txt<br />Get-MessageClassification | fl * &gt; c:\backup\Get-MessageClassification.txt<br />Get-MessageTrackingLog | fl * &gt; c:\backup\Get-MessageTrackingLog.txt<br />Get-MigrationBatch | fl * &gt; c:\backup\Get-MigrationBatch.txt<br />Get-MigrationConfig | fl * &gt; c:\backup\Get-MigrationConfig.txt<br />Get-MigrationEndpoint | fl * &gt; c:\backup\Get-MigrationEndpoint.txt<br />Get-MigrationStatistics | fl * &gt; c:\backup\Get-MigrationStatistics.txt<br />Get-MigrationUser | fl * &gt; c:\backup\Get-MigrationUser.txt<br />Get-MobileDevice | fl * &gt; c:\backup\Get-MobileDevice.txt<br />Get-MobileDeviceMailboxPolicy | fl * &gt; c:\backup\Get-MobileDeviceMailboxPolicy.txt<br />Get-MoveRequest | fl * &gt; c:\backup\Get-MoveRequest.txt<br />Get-NetworkConnectionInfo | fl * &gt; c:\backup\Get-NetworkConnectionInfo.txt<br />Get-Notification | fl * &gt; c:\backup\Get-Notification.txt<br />Get-OabVirtualDirectory | fl * &gt; c:\backup\Get-OabVirtualDirectory.txt<br />Get-OfflineAddressBook | fl * &gt; c:\backup\Get-OfflineAddressBook.txt<br />Get-OrganizationalUnit | fl * &gt; c:\backup\Get-OrganizationalUnit.txt<br />Get-OrganizationConfig | fl * &gt; c:\backup\Get-OrganizationConfig.txt<br />Get-OrganizationRelationship | fl * &gt; c:\backup\Get-OrganizationRelationship.txt<br />Get-OutlookAnywhere | fl * &gt; c:\backup\Get-OutlookAnywhere.txt<br />Get-OutlookProtectionRule | fl * &gt; c:\backup\Get-OutlookProtectionRule.txt<br />Get-OutlookProvider | fl * &gt; c:\backup\Get-OutlookProvider.txt<br />Get-OwaMailboxPolicy | fl * &gt; c:\backup\Get-OwaMailboxPolicy.txt<br />Get-OwaVirtualDirectory | fl * &gt; c:\backup\Get-OwaVirtualDirectory.txt<br />Get-PartnerApplication | fl * &gt; c:\backup\Get-PartnerApplication.txt<br />Get-PendingFederatedDomain | fl * &gt; c:\backup\Get-PendingFederatedDomain.txt<br />Get-PolicyTipConfig | fl * &gt; c:\backup\Get-PolicyTipConfig.txt<br />Get-PopSettings | fl * &gt; c:\backup\Get-PopSettings.txt<br />Get-PowerShellVirtualDirectory | fl * &gt; c:\backup\Get-PowerShellVirtualDirectory.txt<br />Get-PublicFolder | fl * &gt; c:\backup\Get-PublicFolder.txt<br />Get-PublicFolder | Get-PublicFolderClientPermission | fl * &gt; c:\backup\Get-PublicFolderClientPermission.txt<br />Get-PublicFolderDatabase | fl * &gt; c:\backup\Get-PublicFolderDatabase.txt<br />Get-PublicFolder | Get-PublicFolderItemStatistics | fl * &gt; c:\backup\Get-PublicFolderItemStatistics.txt<br />Get-PublicFolder | Get-PublicFolderMailboxDiagnostics | fl * &gt; c:\backup\Get-PublicFolderMailboxDiagnostics.txt<br />Get-PublicFolderMailboxMigrationRequest | fl * &gt; c:\backup\Get-PublicFolderMailboxMigrationRequest.txt<br />Get-PublicFolder | Get-PublicFolderMailboxMigrationRequestStatistics | fl * &gt; c:\backup\Get-PublicFolderMailboxMigrationRequestStatistics.txt<br />Get-PublicFolderMigrationRequest | fl * &gt; c:\backup\Get-PublicFolderMigrationRequest.txt<br />Get-PublicFolder | Get-PublicFolderMigrationRequestStatistics | fl * &gt; c:\backup\Get-PublicFolderMigrationRequestStatistics.txt<br />Get-PublicFolderMoveRequest | fl * &gt; c:\backup\Get-PublicFolderMoveRequest.txt<br />Get-PublicFolder | Get-PublicFolderMoveRequestStatistics | fl * &gt; c:\backup\Get-PublicFolderMoveRequestStatistics.txt<br />Get-PublicFolderStatistics | fl * &gt; c:\backup\Get-PublicFolderStatistics.txt<br />Get-Mailbox | Get-PushNotificationSubscription | fl * &gt; c:\backup\Get-PushNotificationSubscription.txt<br />Get-Queue | fl * &gt; c:\backup\Get-Queue.txt<br />Get-ReceiveConnector | fl * &gt; c:\backup\Get-ReceiveConnector.txt<br />Get-Recipient | fl * &gt; c:\backup\Get-Recipient.txt<br />Get-RecipientFilterConfig | fl * &gt; c:\backup\Get-RecipientFilterConfig.txt<br />Get-RemoteDomain | fl * &gt; c:\backup\Get-RemoteDomain.txt<br />Get-RemoteMailbox | fl * &gt; c:\backup\Get-RemoteMailbox.txt<br />Get-ResourceConfig | fl * &gt; c:\backup\Get-ResourceConfig.txt<br />Get-ResubmitRequest | fl * &gt; c:\backup\Get-ResubmitRequest.txt<br />Get-RetentionPolicy | fl * &gt; c:\backup\Get-RetentionPolicy.txt<br />Get-RetentionPolicyTag | fl * &gt; c:\backup\Get-RetentionPolicyTag.txt<br />Get-RMSTemplate | fl * &gt; c:\backup\Get-RMSTemplate.txt<br />Get-RoleAssignmentPolicy | fl * &gt; c:\backup\Get-RoleAssignmentPolicy.txt<br />Get-RoleGroup | fl * &gt; c:\backup\Get-RoleGroup.txt<br />Get-RoleGroup | Get-RoleGroupMember | fl * &gt; c:\backup\Get-RoleGroupMember.txt<br />Get-RpcClientAccess | fl * &gt; c:\backup\Get-RpcClientAccess.txt<br />Get-SearchDocumentFormat | fl * &gt; c:\backup\Get-SearchDocumentFormat.txt<br />Get-SecurityPrincipal | fl * &gt; c:\backup\Get-SecurityPrincipal.txt<br />Get-SendConnector | fl * &gt; c:\backup\Get-SendConnector.txt<br />Get-SenderFilterConfig | fl * &gt; c:\backup\Get-SenderFilterConfig.txt<br />Get-SenderIdConfig | fl * &gt; c:\backup\Get-SenderIdConfig.txt<br />Get-SenderReputationConfig | fl * &gt; c:\backup\Get-SenderReputationConfig.txt<br />get-mailboxserver | Get-ServerComponentState | fl * &gt; c:\backup\Get-ServerComponentState.txt<br />get-mailboxserver | Get-ServerHealth | fl * &gt; c:\backup\Get-ServerHealth.txt<br />Get-SettingOverride | fl * &gt; c:\backup\Get-SettingOverride.txt<br />Get-SharingPolicy | fl * &gt; c:\backup\Get-SharingPolicy.txt<br />Get-SiteMailbox | fl * &gt; c:\backup\Get-SiteMailbox.txt<br />Get-SiteMailboxProvisioningPolicy | fl * &gt; c:\backup\Get-SiteMailboxProvisioningPolicy.txt<br />Get-SmimeConfig | fl * &gt; c:\backup\Get-SmimeConfig.txt<br />get-mailbox | Get-StoreUsageStatistics | fl * &gt; c:\backup\Get-StoreUsageStatistics.txt<br />Get-SyncConfig | fl * &gt; c:\backup\Get-SyncConfig.txt<br />Get-SystemMessage | fl * &gt; c:\backup\Get-SystemMessage.txt<br />get-mailbox | Get-TextMessagingAccount | fl * &gt; c:\backup\Get-TextMessagingAccount.txt<br />Get-ThrottlingPolicy | fl * &gt; c:\backup\Get-ThrottlingPolicy.txt<br />Get-ThrottlingPolicyAssociation | fl * &gt; c:\backup\Get-ThrottlingPolicyAssociation.txt<br />Get-TransportAgent | fl * &gt; c:\backup\Get-TransportAgent.txt<br />Get-TransportConfig | fl * &gt; c:\backup\Get-TransportConfig.txt<br />Get-TransportPipeline | fl * &gt; c:\backup\Get-TransportPipeline.txt<br />Get-TransportRule | fl * &gt; c:\backup\Get-TransportRule.txt<br />Get-TransportRuleAction | fl * &gt; c:\backup\Get-TransportRuleAction.txt<br />Get-TransportRulePredicate | fl * &gt; c:\backup\Get-TransportRulePredicate.txt<br />Get-TransportService | fl * &gt; c:\backup\Get-TransportService.txt<br />Get-Trust | fl * &gt; c:\backup\Get-Trust.txt<br />Get-UMActiveCalls | fl * &gt; c:\backup\Get-UMActiveCalls.txt<br />Get-UMAutoAttendant | fl * &gt; c:\backup\Get-UMAutoAttendant.txt<br />Get-UMCallAnsweringRule | fl * &gt; c:\backup\Get-UMCallAnsweringRule.txt<br />Get-UMCallRouterSettings | fl * &gt; c:\backup\Get-UMCallRouterSettings.txt<br />Get-UMDialPlan | fl * &gt; c:\backup\Get-UMDialPlan.txt<br />Get-UMHuntGroup | fl * &gt; c:\backup\Get-UMHuntGroup.txt<br />Get-UMIPGateway | fl * &gt; c:\backup\Get-UMIPGateway.txt<br />Get-UMMailbox | fl * &gt; c:\backup\Get-UMMailbox.txt<br />get-mailbox | Get-UMMailboxConfiguration | fl * &gt; c:\backup\Get-UMMailboxConfiguration.txt<br />Get-UMMailboxPIN | fl * &gt; c:\backup\Get-UMMailboxPIN.txt<br />Get-UMMailboxPolicy | fl * &gt; c:\backup\Get-UMMailboxPolicy.txt<br />get-mailbox | Get-UMPhoneSession | fl * &gt; c:\backup\Get-UMPhoneSession.txt<br />Get-UMService | fl * &gt; c:\backup\Get-UMService.txt<br />Get-User | fl * &gt; c:\backup\Get-User.txt<br />Get-UserPhoto | fl * &gt; c:\backup\Get-UserPhoto.txt<br />Get-UserPrincipalNamesSuffix | fl * &gt; c:\backup\Get-UserPrincipalNamesSuffix.txt<br />Get-WebServicesVirtualDirectory | fl * &gt; c:\backup\Get-WebServicesVirtualDirectory.txt<br />Get-X400AuthoritativeDomain | fl * &gt; c:\backup\Get-X400AuthoritativeDomain.txt</pre>
<p style="text-align: justify;">&nbsp;Теперь приступаем к резервному копированию баз данных Exchange 2013 (Windows Backup Server должен быть установлен на сервере с Exchange 2013). Информация ниже показывает, что никаких бекапов никогда не было сделано.</p>
<pre><strong>Get-MailboxDatabase -status | fl Name,EdbFilePath,*Backup</strong><br /><br />Name : Mailbox Database 1769149983<br />EdbFilePath : C:\Program Files\Microsoft\Exchange Server\V15\Mailbox\Mailbox Database 1769149983\Mailbox Database 1769149983.edb<br />SnapshotLastFullBackup : True<br />SnapshotLastIncrementalBackup :<br />SnapshotLastDifferentialBackup :<br />SnapshotLastCopyBackup : True<br />LastFullBackup :&nbsp;<br />LastIncrementalBackup :<br />LastDifferentialBackup :<br />LastCopyBackup :&nbsp;<br />RetainDeletedItemsUntilBackup : False<br /><br />Name : DB1<br />EdbFilePath : E:\DB\DB1.edb<br />SnapshotLastFullBackup : True<br />SnapshotLastIncrementalBackup :<br />SnapshotLastDifferentialBackup :<br />SnapshotLastCopyBackup : True<br />LastFullBackup :&nbsp;<br />LastIncrementalBackup :<br />LastDifferentialBackup :<br />LastCopyBackup :&nbsp;<br />RetainDeletedItemsUntilBackup : False</pre>
<p style="text-align: justify;">&nbsp;Выполняем резервную копию только одной базы в ручную с помощью утилиты wbadmin.exe. Место хранения бекапа - общая сетевая папка на контроллеле домена (в идеале хранить копии лучше на сервере, который расположен в отдельном помещении) Скрипт можно запускать с помощью планировщика задач:</p>
<pre>C:\&gt;<strong>wbadmin.exe START BACKUP -backupTarget:\\dc1\backup\ -include:E: -vssfull -quiet</strong><br />wbadmin 1.0 - Backup command-line tool<br />(C) Copyright 2004 Microsoft Corp.<br /><br />Note: The backed up data cannot be securely protected at this destination.<br />Backups stored on a remote shared folder might be accessible by other<br />people on the network. You should only save your backups to a location<br />where you trust the other users who have access to the location or on a<br />network that has additional security precautions in place.<br /><br />Retrieving volume information...<br />This will back up volume New Volume(E:) to \\dc1\backup\.<br />The backup operation to \\dc1\backup\ is starting.<br />Creating a shadow copy of the volumes specified for backup...<br />Running a consistency check for the application Exchange.<br />Running a consistency check for the application Exchange.<br />Creating a backup of volume New Volume(E:), copied (50%).<br />The backup of volume New Volume(E:) successfully completed.<br />The backup operation successfully completed.<br />Summary of the backup operation:<br />------------------<br /><br /><strong>The backup of volume New Volume(E:) successfully completed.</strong></pre>
<pre>C:\&gt;<strong>Get-MailboxDatabase -status | fl Name,EdbFilePath,*Backup</strong><br /><br />Name : Mailbox Database 1769149983<br />EdbFilePath : C:\Program Files\Microsoft\Exchange Server\V15\Mailbox\Mailbox Database 1769149983\Mailbox Database 1769149983.edb<br />SnapshotLastFullBackup : True<br />SnapshotLastIncrementalBackup :<br />SnapshotLastDifferentialBackup :<br />SnapshotLastCopyBackup : True<br />LastFullBackup :&nbsp;<br />LastIncrementalBackup :<br />LastDifferentialBackup :<br />LastCopyBackup :&nbsp;<br />RetainDeletedItemsUntilBackup : False<br /><br />Name : DB1<br />EdbFilePath : E:\DB\DB1.edb<br />SnapshotLastFullBackup : True<br />SnapshotLastIncrementalBackup :<br />SnapshotLastDifferentialBackup :<br />SnapshotLastCopyBackup : True<br /><strong>LastFullBackup : 10.11.2017 19:34:28</strong><br />LastIncrementalBackup :<br />LastDifferentialBackup :<br />LastCopyBackup :<br />RetainDeletedItemsUntilBackup : False</pre>
<p style="text-align: justify;">&nbsp;Собственно, вот и всё резервное копирование. Довольно таки просто всё делается с помощью комадной строки и powershell. Куда интереснее будет восстанавливать и базу, серверный и пользовательские настройки.</p>
<p style="text-align: right;"><em>10.11.2017</em></p>
<div id="vk_comments" style="text-align: right;"></div>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/ru_RU/sdk.js#xfbml=1&version=v2.8";
  fjs.parentNode.insertBefore(js, fjs);
 }(document, 'script', 'facebook-jssdk'));</script>
<div class="fb-comments" data-href="http://exonix.ru/#!%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D0%B8/Windows_Server/Active_Directory/Office_365_-_DirSync/" data-width="670" data-numposts="20"></div>
</body>
</html>